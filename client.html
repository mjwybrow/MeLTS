<!DOCTYPE html>
<html>
   <head>
		<script src="http://118.138.154.21:8000/socket.io/socket.io.js"></script>
		<link rel="stylesheet" href="jquery.mobile-1.1.1.min.css" /> 
		<script type="text/javascript" src="jquery-1.8.0.min.js"></script>
		<script type="text/javascript" src="jquery.mobile-1.1.1.min.js"></script>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
      <script type="text/javascript">
		$.post("http://syngtest.myproject/username.php", function(data){
	
		var name = data;
		var socket = io.connect('http://118.138.154.21:8000');
         
         // at document read (runs only ones).
         $(document).ready(function(){
            // on click of the button (jquery thing)
            // the things inside this clause happen only when 
            // the button is clicked.
            $('#post_question_submit').click(function(){
            
               // just some simple logging
               $("p#log").html('sent message: ' + $("input#lec_ques").val());
               
               // send message on inputbox to server
               socket.emit('ques', { 
					ques: $("input#lec_ques").val(),
					A: $("input#A").val(),
					B: $("input#B").val(),
					C: $("input#C").val(),
					D: $("input#D").val()
				});
               
               // the server will recieve the message, 
               // then maybe do some processing, then it will 
               // broadcast it again. however, it will not 
               // send it to the original sender. the sender
               // will be the browser that sends the msg. 
               // other browsers listening to the server will
               // recieve the emitted message. therefore we will
               // need to manually print this msg for the sender.
               $("p#data_recieved").append("<br />\r\n" + name + ': ' + $("input#lec_ques").val());
               
               // then we empty the text on the input box.
               $("input#lec_ques").val('');
            });
            
            // ask for the name of the user, ask again if no name.
            while (name == '') {
               name = prompt("What's your name?","");
            }
            
            // send the name to the server, and the server's 
            // register wait will recieve this.
            socket.emit('register', name );
         });
         
         // listen for chat event and recieve data
         socket.on('ques', function (data) {
         
            // print data (jquery thing)
            $("p#data_received").append("<br />\r\n" + data.ques + ': A.' + data.A+ '     B.'+ data.B+'     C.'+ data.C+'     D.'+ data.D);
            
            // we log this event for fun :D
            $("p#log").html('got message from: ' + data.msgr);
            
         });
			
		});


      </script>
   </head>
   <body>
  <!-- Lecturer sessionpage -->
<div data-role="page" id="lec_sessionpage">
	
	<div data-role="header">
	
	</div><!-- /header -->
	<div data-role="content">

		<div>
			<p>Post a question</p>
		</div>
		<div>
			<label for="unit_code">Question</label>
			<input type="text" id="lec_ques" />
		</div>
		
		<div>
			<label for="unit_name">A</label>
			<input type="text" id="A" />
		</div>
		<div>
			<label for="unit_name">B</label>
			<input type="text" id="B" />
		</div>
		<div>
			<label for="unit_name">C</label>
			<input type="text" id="C" />
		</div>
		<div>
			<label for="unit_name">D</label>
			<input type="text" id="D" />
		</div>
		
		<p id='log'>
		</p>
		<p id='data_received'>
		</p>
		
		
		<fieldset>
			<div><button type="button" data-theme="e" id="post_question_submit">Post Question</button></div>
		</fieldset>
		
		<!-- Buttons to direct to other functions -->
		<div data-role="controlgroup">
			<br>
			<a href="index.html" data-role="button">Yes</a>
			<a href="index.html" data-role="button">No</a>
			<a href="index.html" data-role="button">Maybe</a>
		</div>
		
		<!-- Buttons to direct to other functions -->
		<div>
			<a href="view_unitpage.html" rel="external" data-role="button" data-mini = "true" id="end_session">End Session</a>
		</div>


	</div><!-- /content -->

</div><!-- /page --> 
   </body>
</html>